/* ===== 層級 ===== */
#preloader {
    position: fixed;
    inset: 0;
    z-index: 10002;
    background: #000;
    transition: opacity .8s
}

#preloader.fade-out {
    opacity: 0;
    pointer-events: none
}

#intro {
    position: fixed;
    inset: 0;
    z-index: 10001;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at center, #320038 10%, #08004d 25%, #000000 60%);
    transition: opacity 1.5s ease;
    overflow: hidden;
}

#intro.fade-out {
    opacity: 0;
    pointer-events: none
}

#intro.fade-out::after {
  content:"";
  position:absolute;
  inset:0;
  background:radial-gradient(circle at center, rgba(255,255,255,0.4) 0%, transparent 80%);
  opacity:0;
  animation:introSoftGlow 1s ease both;
}

@keyframes introSoftGlow {
  0%   { opacity:0; }
  50%  { opacity:0.5; }
  100% { opacity:0; }
}


/* ===== Logo（圖片版）+ Glitch ===== */
.intro-logo{
  position:relative;
  width:220px; max-width:80vw;
  filter: url(#glitchFilter);
  /* 額外質感：發光 */
  filter: url(#glitchFilter) drop-shadow(0 0 8px #00e0ff);
}

.subtitle {
    color: #b0ffff;
    font-size: 1.05rem;
    margin-top: .6rem;
    opacity: .85;
}

#startBtn {
    margin-top: 32px;
    padding: 12px 30px;
    border: 0;
    border-radius: 10px;
    background: #35b597;
    color: #000;
    font-weight: 700;
    font-size: 1.05rem;
    cursor: pointer;
    box-shadow: 0 0 12px #35b597, 0 0 24px #35b59766;
    transition: .25s;
}

#startBtn:hover {
    background: #fff;
    transform: translateY(-1px) scale(1.04)
}

/* 因為用了 SVG 濾鏡，給它時序上偶發的抖動更像故障 */
@keyframes jitter {
  0%,100% { transform: translate(0,0) }
  20%     { transform: translate(-1px, 0.5px) }
  40%     { transform: translate(1px, -0.5px) }
  60%     { transform: translate(-0.5px, -1px) }
  80%     { transform: translate(0.5px, 1px) }
}
#glitchLogo { animation: jitter 0.9s steps(6,end) infinite; }

/* ===== 粒子畫布 ===== */
#fragmentCanvas {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    opacity: 0
}

/* ===== 輔助動畫 ===== */
@keyframes flicker {

    0%,
    18%,
    20%,
    22%,
    25%,
    53%,
    55%,
    100% {
        opacity: 1
    }

    19%,
    21%,
    23%,
    24%,
    54% {
        opacity: .4
    }
}

@keyframes glowPulse {
    from {
        text-shadow: 0 0 10px #35b597, 0 0 30px #35b597
    }

    to {
        text-shadow: 0 0 40px #35b597, 0 0 80px #35b597
    }
}

/* 無動畫偏好 */
@media (prefers-reduced-motion:reduce) {

    #intro,
    #preloader,
    #startBtn {
        transition: none
    }

    .intro-logo {
        animation: none
    }

    .intro-logo.glitch::before,
    .intro-logo.glitch::after {
        animation: none
    }
}

/* 讓圖片一直掛著 SVG 濾鏡 */
#introLogoImg.glitch { filter: url(#glitchFilter); }

/* 啟動閃爍（和 SVG 濾鏡同時播放） */
.logo-flicker { animation: logoFlicker 1.8s ease-in-out infinite; }

@keyframes logoFlicker {
  0%{
    opacity:0;
    filter: url(#glitchFilter) brightness(.4) contrast(1.2)
            drop-shadow(2px 0 2px red) drop-shadow(-2px 0 2px cyan);
  }
  15%{
    opacity:.9;
    filter: url(#glitchFilter) brightness(1.3) contrast(1.4)
            drop-shadow(3px 0 3px red) drop-shadow(-3px 0 3px cyan);
  }
  30%{
    opacity:.4;
    filter: url(#glitchFilter) brightness(.8) contrast(1.2)
            drop-shadow(1px 0 2px red) drop-shadow(-1px 0 2px cyan);
  }
  45%{
    opacity:1;
    filter: url(#glitchFilter) brightness(1.2) contrast(1.3)
            drop-shadow(2px 0 2px red) drop-shadow(-2px 0 2px cyan);
  }
  60%{
    opacity:.6;
    filter: url(#glitchFilter) brightness(.9) contrast(1.1)
            drop-shadow(2px 0 2px cyan) drop-shadow(-2px 0 2px red);
  }
  80%{
    opacity:1;
    filter: url(#glitchFilter) brightness(1.2) contrast(1.2)
            drop-shadow(1px 0 1px red) drop-shadow(-1px 0 1px cyan);
  }
  100%{
    opacity:1;
    filter: url(#glitchFilter) brightness(1) contrast(1);
  }
}
/* ── 常駐：SVG 濾鏡 + 色偏（RGB 分色） ───────────────── */
#introLogoImg.glitch {
  /* 先套 SVG 濾鏡，再疊色偏與對比，順序很重要！ */
  filter: url(#glitchFilter)
          brightness(1.05) contrast(1.15)
          drop-shadow(2px 0 2px #ff0044)
          drop-shadow(-2px 0 2px #00ffff);
  /* 持續的微抖動畫（不刺眼） */
  animation: glitchRGBShift 2.4s ease-in-out infinite alternate;
  will-change: transform, filter;
}

/* CRT 風微抖＋色偏交換（柔和） */
@keyframes glitchRGBShift {
  0% {
    transform: translate(0,0) skew(0deg);
    filter: url(#glitchFilter)
            brightness(1.05) contrast(1.15)
            drop-shadow(2px 0 2px #ff0044)
            drop-shadow(-2px 0 2px #00ffff);
  }
  25% {
    transform: translate(1px,-1px) skew(-0.4deg);
    filter: url(#glitchFilter)
            brightness(1.08) contrast(1.18)
            drop-shadow(2px 0 2px #00ffff)
            drop-shadow(-2px 0 2px #ff0044);
  }
  50% {
    transform: translate(-1px,1px) skew(0.3deg);
    filter: url(#glitchFilter)
            brightness(1.06) contrast(1.16)
            drop-shadow(1px 0 1px #00ffff)
            drop-shadow(-1px 0 1px #ff0044);
  }
  75% {
    transform: translate(0,1px) skew(0deg);
    filter: url(#glitchFilter)
            brightness(1.08) contrast(1.18)
            drop-shadow(2px 0 2px #ff0044)
            drop-shadow(-2px 0 2px #00ffff);
  }
  100% {
    transform: translate(0,0) skew(0deg);
    filter: url(#glitchFilter)
            brightness(1.05) contrast(1.12)
            drop-shadow(1px 0 1px #00ffff)
            drop-shadow(-1px 0 1px #ff0044);
  }
}

/* 可點提示（你現在用點圖片開始） */
#introLogoImg { cursor: pointer; }
#introLogoImg:hover { opacity: .85; transition: opacity .2s ease; }
